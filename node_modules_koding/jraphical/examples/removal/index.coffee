{ Module } = require '../../lib'

Module.setClient 'localhost:27017/test'

class Bar extends Module
  @set
    schema        :
      random      :
        type      : Number
        default   : -> Math.floor Math.random() * 1000

class Foo extends Module
  @set
    schema        :
      random      :
        type      : Number
        default   : -> Math.floor Math.random() * 1000
    relationships :
      bar         : Bar

foo = new Foo
bar = new Bar
bar2 = new Bar

foo.save (err) ->
  throw err if err
  bar.save (err) ->
    throw err if err
    bar2.save (err) ->
      throw err if err
      foo.addBar bar, { respondWithCount: yes }, (err, docs, count) ->
        throw err if err
        console.log "New count: #{count}"
        foo.addBar bar2, { respondWithCount: yes }, (err, docs, count) ->
          throw err if err
          console.log "New count: #{count}"
          removeNodeExample (err) ->
            throw err if err
            foo.fetchBars (err, bars) ->
              console.log "New count #{bars.length}"




removeNodeExample = (callback) ->
  bar2.remove callback

removeEdgeExample = (callback) ->
  foo.removeBar bar, { respondWithCount: yes }, callback
