{ ModelCursor } = require 'bongo'

module.exports = class CapsuleCursor extends ModelCursor

  { defineProperties } = Object

  constructor:(mongoCursor, types) ->
    defineProperties this,
      mongoCursor :
        value     : mongoCursor
      types       :
        value     : types

  nextModel:(callback) ->
    @nextObject (err, doc) =>
      if err
        callback err
      else
        callback null, if doc? then new @types[doc.type] doc
