require './view', (View) ->

  class NoteView extends View

    partial:(data) ->
      """
      <h2 class="subject">#{data.subject}</h2>
      <div class="body">#{data.body}</div>
      """

    resize          : -> doResizeStuff()

    scroll          : -> doScrollStuff()

    click           :
      '.subject'    : -> doSubjectStuff()
      '.body'       : -> doBodyStuff()

  class NoteLengthCounterView extends View

    partial:(data) ->
      """
      The subject of the note is now #{data.subject.length} characters.
      """

  window.onload = ->
    bongo.connect (api, conn) ->

      { Note } = api

      note = new Note
        subject: 'this is a test'
        body: 'this is a test body section.'

      note.save (err) ->
        throw err if err

        noteView = new NoteView note
        noteLengthView = new NoteLengthCounterView note
        noteView.appendTo document.body
        noteLengthView.appendTo document.body

        prefix = []
        setInterval ->
          prefix.push 'up'
          note.update { subject: "this is an #{prefix?.join('-')}dated test" }
        , 1500
