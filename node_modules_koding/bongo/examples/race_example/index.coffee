race = require '../../lib/race'

ordered = []
foo = race (i, foo, done) ->
  setTimeout ->
    console.log "done with iteration #{i}"
    ordered[i] = i
    done()
  , Math.random() * 4000
, -> console.log 'all done', ordered

hundred = 100
while hundred--
  foo 'value'
