#!/usr/bin/env coffee

argv = require('minimist')(process.argv.slice(2))
AWS  = require 'aws-sdk'

AWS.config.region = 'us-east-1'
AWS.config.update
  accessKeyId     : ''
  secretAccessKey : ''

EC2  = new AWS.EC2()

{environment} = argv

params =
  Filters: [
    {
      Name: 'tag:Name'
      Values: [environment]
    }
    {
      Name: 'instance-state-name'
      Values: ['running']
    }
  ]

EC2.describeInstances params, (err, data) ->
  data.Reservations.forEach (reservation) ->
    reservation.Instances.forEach (instance) ->
      console.log instance.PublicDnsName
