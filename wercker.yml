box: koding/base@0.0.11

build:
  steps:
    - script:
        name: build go binaries
        code: go/build.sh
    - script:
        name: install debuild
        code: |
          sudo apt-get update -y
          sudo apt-get install ubuntu-dev-tools -y

deploy:
  steps:
    - script:
        name: package klient.deb
        code: |
          export GOPATH=$PWD/go
          go run go/package.go -a klient -e development
          go build -v -ldflags |
            "-X koding/kites/klient/protocol.Version 0.1.0 \
             -X koding/kites/klient/protocol.Environment development" \
             koding/kites/klient
          gzip -N klient
          mv klient.gz klient-0.1.0.gz
    - koding/s3put@0.0.3:
          key-id: $S3_KEY_ID
          key-secret: $S3_KEY_SECRET
          file: klient-0.1.0.gz
          url: s3://$S3_KLIENTKITE
    - igungor/s3del@0.0.1:
          key-id: $S3_KEY_ID
          key-secret: $S3_KEY_SECRET
          recursive: true
          url: s3://$S3_KLIENTKITE/development/
